[!- extends "_wrappers/main.html" -!]

[! block head !]
<link rel="stylesheet" href="/deck-refiner/~support/styles.css" />
[! endblock !]

[! block main_tag !]
<main class="default-flow xxxlarge-wrapper">
[!- endblock -!]

[!- block main -!]
<template id="card">
  <div 
    class="card-wrapper" 
    data-cardfilter="CARD_FILTER"
    data-category="CARD_CATEGORY"
    data-id="CARD_ID"
    data-position="CARD_POSITION"
    data-receive="showCard" 
    data-send="showCard" 
    data-state="CARD_INITIAL_STATE"
    data-controls="hidden"
    >
      <div class="main">
        <div class="card-quantity-wrapper">
          <div class="card-quantity">CARD_QUANTITY</div>
          <div class="card-controls">
            <button data-id="CARD_ID" data-send="increaseQuantity">+</button>
            <button data-id="CARD_ID" data-send="decreaseQuantity">-</button>
          </div>
        </div>
        <div class="card-image-wrapper">CARD_IMAGE</div>
        <div class="card-right-sidebar">
          <div class="card-stars">.</div>

          <div class="card-controls">
            <!--
            <button data-id="CARD_ID" data-send="setCardFilter" data-cardfilter="2">2</button>
            <button data-id="CARD_ID" data-send="setCardFilter" data-cardfilter="1">1</button>
            <button data-id="CARD_ID" data-send="setCardFilter" data-cardfilter="0">0</button>
            <button data-id="CARD_ID" data-send="setCardFilter" data-cardfilter="-1">x</button>
-->
          </div>
        </div>
      </div>
      <div class="footer card-controls text-align-center">
        <button data-id="CARD_ID" data-send="setCardFilter" data-cardfilter="-1">x</button>
        <button data-id="CARD_ID" data-send="setCardFilter" data-cardfilter="0">0</button>
        <button data-id="CARD_ID" data-send="setCardFilter" data-cardfilter="1">1</button>
        <button data-id="CARD_ID" data-send="setCardFilter" data-cardfilter="2">2</button>
      </div>
  </div>
</template>

<template id="category">
  <div class="category-wrapper">
    <div class="category-title">CATEGORY_NAME (CATEGORY_CARD_QUANTITY)</div>
    <div class="category-cards">CARDS_FOR_CATEGORY</div>
  </div>
</template>

  <hgroup>
    <h1>Deck Refiner</h1>
  </hgroup>

<bitty-8-0 
  data-connect="/deck-refiner/~support/deck-refiner.js DeckRefiner"
  data-listeners="click input mouseover"
>

  <details>
    <summary>Change Deck</summary>
    <div class="faded-default-border default-border-radius default-padding default-flow">
      <p>Follow these prompts to start refining a new deck:</p>
      <div class="default-padding info-border default-border-radius default-flow" data-receive="changeDeckStep2 changeDeckStep3 changeDeckComplete">
        Copy the address of an  
        <a href="https://archidekt.com/">Archidekt</a> deck 
        you want to refine and paste it here:
        <input type="text" data-send="changeDeckURL" autocomplete="off" />
        <div class="faded-accent-border default-border-radius default-padding">
          <div>It'll look something like:</div>
          <pre>https://archidekt.com/decks/19207437/giada_angels</pre>
        </div>
      </div>
    </div>
  </details>

  <div class="deck-wrapper" data-receive="deckFilter">
    <div class="filter-wrapper faded-accent-block-border">
      <div>
          Filter:
        <button data-send="setDeckFilter" data-receive="deckFilterButtonStatus" data-deckfilter="-1">x</button>
          |
        <button data-send="setDeckFilter" data-receive="deckFilterButtonStatus" data-deckfilter="0">0</button>
        <button data-send="setDeckFilter" data-receive="deckFilterButtonStatus" data-deckfilter="1">1</button>
        <button data-send="setDeckFilter" data-receive="deckFilterButtonStatus" data-deckfilter="2">2</button>
          Deck Size: <span class="deck-size" data-receive="deckSize"></span>
      </div>
    </div>
    <div class="categories" data-receive="deck" data-send="closeHighlight"></div>
  </div>


  <!-- note: the change-deck-... templates
will be removed when the data is being queried 
directly from the api -->

<template id="change-deck-step-2">
<p>
  The next step is to copy data from the Archidekt site.
</p>
<p>
  Use the button below to open a new tab with the data. 
  Copy it, then come back here. 
</p>
<p>
  <a 
    class="link-button" 
    target="_blank" 
    href="https://archidekt.com/api/decks/ID/" 
    data-send="changeDeckStep3"
  >Open Archidekt Data Page</a></p>
</template>

<template id="change-deck-step-3">
  <p>Paste the data you copied here:</p>
  <div>
    <textarea 
      class="text-box"
      data-send="changeDeckStep4"
    ></textarea>
  </div>
</template>

<template id="change-deck-complete">
  <p>Deck switch complete. </p>
  <p>You can close the Archidekt data tab now.</p>
  <p>Refresh the page if you'd like to switch to another one.</p>
</template>


</bitty-8-0>
[!- endblock -!]


